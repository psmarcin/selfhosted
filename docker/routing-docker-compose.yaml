version: "2.4"
services:
  proxy:
    image: traefik:v2.4         # Review traefik documentation https://doc.traefik.io/traefik/
    container_name: traefik
    network_mode: "host"
    mem_limit: 48m
    mem_reservation: 24m
    command:
      #      - "--log.level=DEBUG"
      - --api.insecure=true
      - --providers.docker=true
      - --providers.docker.exposedbydefault=false
      - --entrypoints.web.address=:9091
      - --entrypoints.websecure.address=:8443

    ports:
      - "9091:9091"
      - "8081:8080"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    restart: unless-stopped

  uptime:
    image: louislam/uptime-kuma:1.10.2
    mem_limit: 128m
    mem_reservation: 64m
    labels:
      - traefik.enable=true
      - traefik.http.services.uptime.loadbalancer.server.port=3001
      - traefik.http.routers.uptime.rule=Host(`up.onet.blog`)
    ports:
      - "9090:3001"
    volumes:
      - /volume1/docker/uptime/data:/app/data